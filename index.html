<canvas id = "canvas" width="1960" height="900" style="border:1px solid #000000;"></canvas>
<link rel="stylesheet" type="text/css" href="./styles/style.css">


<script type="text/javascript" src="./lib/simplex-noise.js"></script>
<script type="text/javascript" src="./scripts/color.js"></script>

<script type="text/javascript">

  // ================================== //
  // canvas
  // ================================== //

  var canvas = document.getElementById("canvas");
  var CANVAS_HEIGHT = 900;
  var CANVAS_WIDTH = 1960;
  var LOWER_LEFT = { x: CANVAS_WIDTH, y: CANVAS_HEIGHT };
  var LOWER_RIGHT = { x: 0, y: CANVAS_HEIGHT };
  var UPPER_LEFT = { x: CANVAS_WIDTH, y: 0 };
  var UPPER_RIGHT = { x: 0, y: 0 };

  var ctx = canvas.getContext("2d");
  ctx.webkitImageSmoothingEnabled = true;
  ctx.translate(0.5, 0.5);
  ctx.imageSmoothingEnabled = true;
  ctx.strokeStyle = "#000000";
  

  // ================================== //
  // noise //
  // ================================== //

  function hillNoise(x, z, type) {
    return type.noise2D(z, x);
  }

  function make1DNoise(params) {
    var newNoise = [];
    var simplex = new SimplexNoise();

    
    for(var i=0; i<CANVAS_WIDTH; i++) {
      newNoise.push({ 
        x: i, 
        y: params.axis + params.amplitude * hillNoise(params.scale * i, params.zaxis, simplex) 
      });  
    }
    
    newNoise.push(LOWER_LEFT); 
    newNoise.push(LOWER_RIGHT);
    return newNoise;
  }

  function fillPath(params) {
    points = make1DNoise(params)
    ctx.fillStyle = primaryColor(params.fillColor);

    ctx.beginPath();
    ctx.moveTo(points[0].x, points[0].y);

    for(var i = 1; i < points.length; i++) {
      ctx.lineTo(points[i].x, points[i].y);
    }

    ctx.lineTo(points[0].x, points[0].y);
    ctx.fill();
    // here the line casts a "shadow" of dots above it, unless it's the first hill
    // ctx.stroke();
    // ctx.shadowOffsetY = 20;
    hillShadow(params.fillColor);
    // console.log(ctx)
  }

  function drawAllHills(params) {
    var hillsParams = params;
    var lightestColor = hillsParams.fillColor.l + (1.2 * hillsParams.times);

    for(var i = 1; i <= params.times; i++) {
      fillPath(params)
      hillsParams.axis = params.axis + 100;
      hillsParams.zaxis = params.zaxis - 1;
      hillsParams.fillColor.l = params.fillColor.l - 0.075;
    }
  }

//   function makeClouds(threshold, offset, variance) {
//     ctx.globalAlpha = 0.4;
//     ctx.beginPath();
//     for(var i=0; i<CANVAS_WIDTH; i++) {
//         for(var j=0; j<CANVAS_HEIGHT; j++) {
//             var noiseValue = simplex.noise2D(i*0.001+offset, 
//                                              j*0.01+offset);
//             if(noiseValue>params.threshold
//                          +Math.random()*params.variance) {
//                 drawPixel({x:i, y:j}, colors.cloudColor);
//             }
//         }
//     }
//     ctx.globalAlpha = 1.0;
// }

  // ================================== //
  // color //
  // ================================== //


  // ================================== //
  // params //
  // ================================== //

  var hillParams = {
    axis: 400,
    amplitude: 60,
    scale: 0.002,
    zaxis: 5, 
    fillColor: hillColor(),
    times: 4
  }

  // function drawSky() {
  //   ctx.fillStyle = 'blue';
  //   ctx.fillRect(0,0,canvas.width, canvas.height);
  // }


  // drawSky()
  drawAllHills(hillParams)

  generateHslaColors(45, 45, 1)


  // new ideas: randomly offset shadowoffset x

  // during day scenes have hills blend into sky color, darker(lower) to lighter(higher)
  // and opposit for night
  // 

  // weekend todos 
  // refactor colors still to be just a single call

  // factor in day and night
  // use original render method to draw day
</script>

